"use strict";(self.webpackChunkjupyterlab_gallery=self.webpackChunkjupyterlab_gallery||[]).push([[274],{274:(e,t,a)=>{a.r(t),a.d(t,{default:()=>w});var r=a(265),s=a(825),i=a(670),n=a(345),o=a(923),l=a(527),c=a(602),p=a(702),d=a(861);async function h(e="",t={}){const a=d.ServerConnection.makeSettings(),r=p.URLExt.join(a.baseUrl,"jupyterlab-gallery",e);let s;try{s=await d.ServerConnection.makeRequest(r,t,a)}catch(e){throw new d.ServerConnection.NetworkError(e)}let i=await s.text();if(i.length>0)try{i=JSON.parse(i)}catch(e){console.log("Not a JSON response body.",s)}if(!s.ok)throw new d.ServerConnection.ResponseError(s,i.message||i);return i}class u extends o.ReactWidget{constructor(e){const{trans:t}=e;super(),this._exhibits=null,this._stream=new c.Stream(this),this._status=t.__("Gallery loading..."),this._actions={open:async t=>{e.openPath(t.localPath)},download:async e=>{await h("pull",{method:"POST",body:JSON.stringify({exhibit_id:e.id})}),await this._load()}},function(e="",t,a){const r=d.ServerConnection.makeSettings(),s=p.URLExt.join(r.baseUrl,"jupyterlab-gallery",e),i=new EventSource(s);i.addEventListener("message",(e=>{const a=JSON.parse(e.data);"finished"!==a.phase&&"error"!==a.phase||i.close(),t(a)})),i.addEventListener("error",(e=>{a(e)}))}("pull",(e=>{this._stream.emit(e)}),(e=>{console.error(e)})),this._load()}async _load(){try{const e=await h("exhibits"),t="1.0";e.apiVersion!==t&&console.warn(`jupyter-gallery API version out of sync, expected ${t}, got ${e.apiVersion}`),this.exhibits=e.exhibits}catch(e){this._status=`jupyterlab_gallery server failed:\n${e}`}}get exhibits(){return this._exhibits}set exhibits(e){this._exhibits=e,this.update()}render(){return this.exhibits?n.createElement(g,{exhibits:this.exhibits,actions:this._actions,progressStream:this._stream}):n.createElement("div",{className:"jp-Gallery jp-mod-loading"},this._status)}}function g(e){return n.createElement("div",{className:"jp-Gallery"},e.exhibits.map((t=>n.createElement(y,{key:t.repository,exhibit:t,actions:e.actions,progressStream:e.progressStream}))))}function y(e){const{exhibit:t,actions:a}=e,[r,s]=n.useState();return n.useEffect((()=>{const a=(e,a)=>{var r;if(a.exhibit_id===t.id)if(console.log("matched stream",a),"error"===a.phase)(0,o.showErrorMessage)("Could not download",null!==(r=a.output)&&void 0!==r?r:"Unknown error");else{const{output:e,phase:t}=a;s(e?t+": "+e:t)}};return e.progressStream.connect(a),()=>{e.progressStream.disconnect(a)}})),n.createElement("div",{className:"jp-Exhibit"},n.createElement("h4",{className:"jp-Exhibit-title"},t.title),n.createElement("img",{src:t.icon,className:"jp-Exhibit-icon",alt:t.title}),n.createElement("div",{className:"jp-Exhibit-description"},t.description),r,n.createElement("div",{className:"jp-Exhibit-buttons"},t.isCloned?n.createElement(l.Button,{onClick:()=>{a.open(t)}},"Open"):n.createElement(l.Button,{onClick:async()=>{s("Downloading"),await a.download(t)}},"Setup up"),t.isCloned&&t.updatesAvailable?n.createElement(l.Button,null,"Update"):null))}const m=new l.LabIcon({name:"jupyterlab-gallery:gallery",svgstr:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path class="jp-icon3" fill="rgb(97,97,97)" d="M1 3V21H23V3H1M21 5V14H3V5H21M11 16V19H8V16H11M3 16H6V19H3V16M13 19V16H16V19H13M18 19V16H21V19H18Z" /></svg>'}),b={id:"jupyterlab-gallery:plugin",description:"A JupyterLab gallery extension for presenting and downloading examples from remote repositories",autoStart:!0,requires:[s.ISettingRegistry],optional:[i.IFileBrowserCommands,r.ITranslator],activate:async(e,t,a,s)=>{console.log("JupyterLab extension jupyterlab-gallery is activated!");const i=(s=null!=s?s:r.nullTranslator).load("jupyterlab-gallery"),n=new u({trans:i,openPath:t=>{if(!a)throw Error("filebrowser not available");e.commands.execute(a.openPath,{path:t})}});n.id="jupyterlab-gallery:sidebar",n.title.icon=m,n.title.caption=i.__("Gallery"),n.show(),e.shell.add(n,"left",{rank:850});try{const e=await t.load(b.id);console.log("jupyterlab-gallery settings loaded:",e.composite)}catch(e){return void console.error("Failed to load settings for jupyterlab-gallery.",e)}}},w=b}}]);