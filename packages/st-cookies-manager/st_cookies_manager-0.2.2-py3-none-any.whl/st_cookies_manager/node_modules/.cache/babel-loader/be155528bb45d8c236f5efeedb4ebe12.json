{"ast":null,"code":"import{Streamlit}from\"streamlit-component-lib\";const targetWindow=window.parent||window;const targetDocument=targetWindow.document;let lastValue=null;function onRender(event){const data=event.detail;saveCookies(data.args[\"queue\"]);const newValue=targetDocument.cookie;if(lastValue!==newValue&&!data.args.saveOnly){Streamlit.setComponentValue(newValue);lastValue=newValue;}}Streamlit.events.addEventListener(Streamlit.RENDER_EVENT,onRender);Streamlit.setComponentReady();Streamlit.setFrameHeight(0);function saveCookies(queue){Object.keys(queue).forEach(name=>{const spec=queue[name];if(spec.value===null)targetDocument.cookie=\"\".concat(encodeURIComponent(name),\"=; max-age=0; path=\").concat(encodeURIComponent(spec.path));else{const date=new Date(spec.expires_at);targetDocument.cookie=\"\".concat(encodeURIComponent(name),\"=\").concat(encodeURIComponent(spec.value),\";\")+\" expires=\".concat(date.toUTCString(),\";\")+\" path=\".concat(encodeURIComponent(spec.path),\";\");}});}","map":{"version":3,"names":["Streamlit","targetWindow","window","parent","targetDocument","document","lastValue","onRender","event","data","detail","saveCookies","args","newValue","cookie","saveOnly","setComponentValue","events","addEventListener","RENDER_EVENT","setComponentReady","setFrameHeight","queue","Object","keys","forEach","name","spec","value","concat","encodeURIComponent","path","date","Date","expires_at","toUTCString"],"sources":["D:/Download/streamlit-cookies-manager-0.2.0/st-cookies-manager-0.2.0/st_cookies_manager/src/index.ts"],"sourcesContent":["import {RenderData, Streamlit} from \"streamlit-component-lib\"\n\nconst targetWindow: Window = window.parent || window\nconst targetDocument = targetWindow.document\n\nlet lastValue: string | null = null\n\ninterface AddCookieSpec {\n    value: string\n    expires_at: string\n    path: string\n}\n\ninterface DeleteCookieSpec {\n    value: null\n    path: string\n}\n\ntype CookieSpec = AddCookieSpec | DeleteCookieSpec\n\nfunction onRender(event: Event): void {\n    const data = (event as CustomEvent<RenderData>).detail\n\n    saveCookies(data.args[\"queue\"])\n\n    const newValue = targetDocument.cookie\n    if (lastValue !== newValue && !data.args.saveOnly) {\n        Streamlit.setComponentValue(newValue)\n        lastValue = newValue\n    }\n}\n\nStreamlit.events.addEventListener(Streamlit.RENDER_EVENT, onRender)\nStreamlit.setComponentReady()\nStreamlit.setFrameHeight(0)\n\n\nfunction saveCookies(queue: { [k in string]: CookieSpec }) {\n    Object.keys(queue).forEach((name) => {\n        const spec = queue[name]\n        if (spec.value === null)\n            targetDocument.cookie = `${encodeURIComponent(name)}=; max-age=0; path=${encodeURIComponent(spec.path)}`\n        else {\n            const date = new Date(spec.expires_at)\n            targetDocument.cookie = (\n                `${encodeURIComponent(name)}=${encodeURIComponent(spec.value)};` +\n                ` expires=${date.toUTCString()};` +\n                ` path=${encodeURIComponent(spec.path)};`\n            )\n        }\n    })\n}"],"mappings":"AAAA,OAAoBA,SAAS,KAAO,yBAAyB,CAE7D,KAAM,CAAAC,YAAoB,CAAGC,MAAM,CAACC,MAAM,EAAID,MAAM,CACpD,KAAM,CAAAE,cAAc,CAAGH,YAAY,CAACI,QAAQ,CAE5C,GAAI,CAAAC,SAAwB,CAAG,IAAI,CAenC,QAAS,CAAAC,QAAQA,CAACC,KAAY,CAAQ,CAClC,KAAM,CAAAC,IAAI,CAAID,KAAK,CAA6BE,MAAM,CAEtDC,WAAW,CAACF,IAAI,CAACG,IAAI,CAAC,OAAO,CAAC,CAAC,CAE/B,KAAM,CAAAC,QAAQ,CAAGT,cAAc,CAACU,MAAM,CACtC,GAAIR,SAAS,GAAKO,QAAQ,EAAI,CAACJ,IAAI,CAACG,IAAI,CAACG,QAAQ,CAAE,CAC/Cf,SAAS,CAACgB,iBAAiB,CAACH,QAAQ,CAAC,CACrCP,SAAS,CAAGO,QAAQ,CACxB,CACJ,CAEAb,SAAS,CAACiB,MAAM,CAACC,gBAAgB,CAAClB,SAAS,CAACmB,YAAY,CAAEZ,QAAQ,CAAC,CACnEP,SAAS,CAACoB,iBAAiB,CAAC,CAAC,CAC7BpB,SAAS,CAACqB,cAAc,CAAC,CAAC,CAAC,CAG3B,QAAS,CAAAV,WAAWA,CAACW,KAAoC,CAAE,CACvDC,MAAM,CAACC,IAAI,CAACF,KAAK,CAAC,CAACG,OAAO,CAAEC,IAAI,EAAK,CACjC,KAAM,CAAAC,IAAI,CAAGL,KAAK,CAACI,IAAI,CAAC,CACxB,GAAIC,IAAI,CAACC,KAAK,GAAK,IAAI,CACnBxB,cAAc,CAACU,MAAM,IAAAe,MAAA,CAAMC,kBAAkB,CAACJ,IAAI,CAAC,wBAAAG,MAAA,CAAsBC,kBAAkB,CAACH,IAAI,CAACI,IAAI,CAAC,CAAE,KACvG,CACD,KAAM,CAAAC,IAAI,CAAG,GAAI,CAAAC,IAAI,CAACN,IAAI,CAACO,UAAU,CAAC,CACtC9B,cAAc,CAACU,MAAM,CACjB,GAAAe,MAAA,CAAGC,kBAAkB,CAACJ,IAAI,CAAC,MAAAG,MAAA,CAAIC,kBAAkB,CAACH,IAAI,CAACC,KAAK,CAAC,kBAAAC,MAAA,CACjDG,IAAI,CAACG,WAAW,CAAC,CAAC,KAAG,UAAAN,MAAA,CACxBC,kBAAkB,CAACH,IAAI,CAACI,IAAI,CAAC,KACzC,CACL,CACJ,CAAC,CAAC,CACN","ignoreList":[]},"metadata":{},"sourceType":"module"}